<div class="container">

  <!-- HEADER DEL DÍA + ENERGÍA -->
  <header class="header-dia">
    <h1>{{ rutina.dia }}</h1>

    <div class="energia">
      Energía: <strong>{{ energiaRestante() }} / {{ rutina.energiaMax }}</strong>
    </div>

    <div class="usuario-info">
      <p>Usuario: <strong>{{ userName }}</strong></p>
      <p>Nivel: <strong>{{ userLevel }}</strong></p>
    </div>
  </header>

  <!-- ESTADO INICIAL -->
  <div class="estado-inicial" *ngIf="!sesionActiva && !sesionFinalizada">
    <div class="card-inicial">

      <h2>Rutina lista para hoy</h2>
      <p>Entrenamiento generado en base a tu progreso.</p>

      <div class="info-energia">
        <strong>Energía disponible:</strong>
        <span class="valor-energia" [class.baja]="energiaRestante() < 30">
          {{ energiaRestante() }} / {{ rutina.energiaMax }}
        </span>
      </div>

      <button class="btn-comenzar" (click)="comenzarEntrenamiento()">
        COMENZAR ENTRENAMIENTO
      </button>

      <div class="tiempo-disponible">
        Tienes 120 minutos disponibles
      </div>
    </div>
  </div>

  <!-- DURANTE EL ENTRENAMIENTO -->
  <div class="durante" *ngIf="sesionActiva">
    <div class="cronometro">
      Tiempo transcurrido: <strong>{{ tiempoTranscurrido() }}</strong> minutos
    </div>

    <button class="btn-finalizar" (click)="finalizarEntrenamiento()">
      Finalizar entrenamiento
    </button>
  </div>

  <!-- LISTA DE EJERCICIOS -->
  <div class="ejercicios" *ngIf="sesionActiva || sesionFinalizada">
    <div
      *ngFor="let ej of rutina.ejercicios; let i = index"
      class="ejercicio"
      [class.hecho]="ej.hecho"
      (click)="marcarEjercicio(ej)"
      [style.cursor]="sesionFinalizada ? 'default' : 'pointer'"
      [style.opacity]="sesionFinalizada && !ej.hecho ? 0.5 : 1">

      <div class="izq">
        <div class="num">{{ i + 1 }}</div>
      </div>

      <div class="centro">
        <div class="nombre">{{ ej.nombre }}</div>
        <div class="detalle">
          {{ ej.sets }}×{{ ej.reps }} • {{ ej.intensidad }}% • ≈{{ ej.tiempo }} min • Coste {{ ej.energia }}

        </div>
      </div>

      <div class="check" *ngIf="ej.hecho">✓</div>
    </div>
  </div>

  <!-- RESUMEN FINAL -->
  <div class="resumen" *ngIf="sesionFinalizada">
    <h3>Entrenamiento completado</h3>

    <p>Tiempo dedicado: <strong>{{ tiempoRealMinutos }} min</strong></p>

    <p>Ejercicios completados:
      <strong>{{ ejerciciosCompletados() }} / {{ rutina.ejercicios.length }}</strong>
    </p>

    <p>Energía consumida:
      <strong>{{ energiaGastada }}</strong>
    </p>

    <p>Energía restante:
      <strong>{{ energiaRestante() }}</strong>
    </p>
  </div>

</div>
